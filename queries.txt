LOAD EMPLOYEE
LOAD DEPARTMENT
LOAD PROJECT
LOAD WORKS_ON
T1 <- CROSS EMPLOYEE DEPARTMENT
T2 <- SELECT Super_ssn == Mgr_ssn FROM T1
T3 <- SELECT Dno != Dnumber FROM T2
RENAME Dnumber TO Super_dno FROM T3
Q1 <- PROJECT Ssn,Dno,Super_ssn,Super_dno FROM T3
CLEAR T1
CLEAR T2
CLEAR T3
T1 <- CROSS PROJECT WORKS_ON
T2 <- SELECT Pnumber == Pno FROM T1
T3 <- CROSS EMPLOYEE T2
T4 <- SELECT Ssn == Essn FROM T3
T5 <- SELECT Dno == Dnum FROM T4
RENAME Dnum TO P_dno FROM T5
Q2 <- PROJECT Ssn,Dno,Pno,P_dno FROM T5
CLEAR T5
T5 <- SELECT Dno != Dnum FROM T4
RENAME Dnum TO P_dno FROM T5
Q3 <- PROJECT Ssn,Dno,Pno,P_dno FROM T5
CLEAR T1
CLEAR T2
CLEAR T3
CLEAR T4
CLEAR T5
T1 <- CROSS EMPLOYEE EMPLOYEE
T2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM T1
T3 <- SELECT EMPLOYEE1_Bdate < EMPLOYEE2_Bdate FROM T2
Q4 <- PROJECT EMPLOYEE2_Ssn,EMPLOYEE2_Bdate,EMPLOYEE1_Ssn,EMPLOYEE1_Bdate FROM T3
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q4
RENAME EMPLOYEE2_Bdate TO Super_bdate FROM Q4
RENAME EMPLOYEE1_Ssn TO Essn FROM Q4
RENAME EMPLOYEE1_Bdate TO E_bdate FROM Q4
CLEAR T1
CLEAR T2
CLEAR T3
T1 <- SELECT Sex == 1 FROM EMPLOYEE
T2 <- SELECT Sex == 0 FROM EMPLOYEE
T3 <- CROSS T1 T2
T4 <- SELECT T1_Dno == T2_Dno FROM T3
Q5 <- PROJECT T1_Dno FROM T4
RENAME T1_Dno TO Dno FROM Q5
CLEAR T1
CLEAR T2
CLEAR T3
CLEAR T4
EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
QUIT
